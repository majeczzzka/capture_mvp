# Capture MVP - Test Documentation

This document provides a comprehensive overview of the testing strategy and test implementations for the Capture MVP application.

## Testing Structure

The testing structure is organized into two main categories:

1. **Unit Tests**: Located in the `/test/unit` directory, these tests verify individual components in isolation.
2. **Integration Tests**: Located in the `/integration_test` directory, these tests verify the interaction between multiple components.

## Unit Tests

Unit tests are organized by component type:

### Model Tests (`/test/unit/models`)

#### Jar Model Tests (`jar_model_test.dart`)

- **Should create a valid Jar with required parameters**: Verifies that a Jar model can be created with title, filter color, images, jar image, and collaborators.
- **Should create a Jar with empty collaborators list**: Tests Jar creation with empty collaborators.
- **Should keep references to lists provided in constructor**: Ensures that modifications to the original lists are reflected in the Jar model.

#### S3 Item Tests (`s3_item_test.dart`)

- **Should create a valid S3Item with required parameters**: Tests creation with basic parameters.
- **Should create a valid S3Item with all parameters**: Tests creation with all optional parameters.
- **isDeletedByUser should return correct values**: Verifies the isDeletedByUser functionality.
- **copyWith should return a new instance with updated values**: Tests the copyWith method.
- **toJson should return the correct JSON map**: Ensures proper JSON serialization.
- **fromFirestore should correctly parse Firestore data**: Tests deserialization from Firestore.
- **fromFirestore should handle missing data with defaults**: Ensures graceful handling of incomplete data.

### Utility Tests (`/test/unit/utils`)

#### App Colors Tests (`app_colors_test.dart`)

- **Should have correctly defined background color**: Validates background color value.
- **Should have correctly defined jarGridBackground color**: Validates jar grid background color.
- **Should have correctly defined fonts color**: Validates font color values.
- **Should have correctly defined navBar color**: Validates navigation bar color.
- **Should have correctly defined selectedFonts color**: Validates selected font color.

#### Month Utility Tests (`month_util_test.dart`)

- **Should return correct month names for valid inputs**: Verifies month name conversion.
- **Should throw RangeError for invalid month numbers**: Tests error handling.
- **Should work with DateTime.month property**: Ensures compatibility with DateTime.

### Service Tests (`/test/unit/services`)

#### S3 Service Tests

- The presence of `s3_service_test.mocks.dart` indicates that S3 service functionality is tested using mocks generated by Mockito.

## Integration Tests

### Firebase Test Setup (`firebase_test_setup.dart`)

This utility class provides infrastructure for testing with Firebase:

- **setupFirebaseForTesting()**: Initializes Firebase with real configurations for testing.
- **wrapAppForTesting()**: Wraps the application with error handling to prevent test crashes.

### App Tests

#### Basic App Functionality (`app_test.dart`)

- Tests the basic application initialization and Firebase integration.

#### Minimal Tests (`minimal_test.dart`, `simple_test.dart`, `bare_minimum_test.dart`)

- These contain simplified tests to verify basic app functionality without complex scenarios.

#### Diagnostic Test (`diagnostic_test.dart`)

- Designed to help diagnose issues in the testing environment.

### Navigation Tests

#### Navigation Test (`navigation_test.dart`)

- Tests app navigation between screens.

#### Form Validation Test (`form_validation_test.dart`)

- Verifies form input validation functionality.

### Feature-Specific Tests

#### Jar Tests (`jar_test.dart`)

- **Navigate to jar content**: Tests the navigation to jar content with real Firebase.
- Verifies login functionality, home screen display, and jar item interaction.

#### Jar Content Test (`jar_content_test.dart`)

- Tests interactions with content inside jars, including navigating through jar items.

#### Jar Creation Test (`jar_creation_test.dart`)

- Tests creating a new jar, including the UI flow and Firebase integration.

#### Content Widget Test (`content_widget_test.dart`)

- Tests the functionality of content-related widgets in isolation.

### Media Handling Tests

#### Video Thumbnail Tests

- **Simplified Video Thumbnail Test** (`simplified_video_thumbnail_test.dart`): Tests a simplified version of thumbnail generation.
- **Video Thumbnail Basic Test** (`video_thumbnail_basic_test.dart`): Tests basic thumbnail functionality.

## Testing Strategy

The testing strategy employs two main approaches:

1. **Unit Testing**:

   - Models are thoroughly tested to ensure data structure integrity.
   - Utility functions are tested for correctness.
   - Services are tested using mocks to isolate functionality.

2. **Integration Testing**:
   - Real Firebase initialization is tested to ensure proper backend connectivity.
   - User interactions are simulated to verify end-to-end functionality.
   - Progressive frame pumping is used to allow asynchronous operations to complete.
   - Error handling ensures tests continue even if some operations fail.

## Test Execution

Tests can be run using the provided `run_firebase_tests.sh` script, which:

1. Allows selection of a device to run tests on.
2. Provides options to run different types of tests.
3. Handles test execution with proper configuration.

## Missing Tests & Future Improvements

Some areas that could benefit from additional testing:

1. **More comprehensive Firebase service unit tests** using mocks.
2. **Enhanced S3 service integration tests** beyond model testing.
3. **User Registration Workflow** tests for account creation.
4. **Profile Management** tests for user settings.
5. **Collaboration Feature** tests for jar sharing.

## Conclusion

The testing infrastructure provides a solid foundation for ensuring the reliability of the Capture MVP application. The combination of unit and integration tests covers the core functionality while allowing for future expansion of test coverage.
